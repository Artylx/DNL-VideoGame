<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- Site icons -->
        <link rel="icon" type="image/png" sizes="32x32" href="/DNL-VideoGame/assets/logo_dnl.png">
        <link rel="apple-touch-icon" sizes="180x180" href="/DNL-VideoGame/assets/logo_dnl.png">
        <title>DNL - Game</title>

        <style>
            .iframe-wrapper {
                position: relative;
                width: 95%;
                height: calc(90vh - 1.4rem);
            }

            .iframe-wrapper iframe {
                width: 100%;
                height: 100%;
                border: none;
                border-radius: 12px;
            }

            .fullscreen-btn {
                position: absolute;
                top: 14px;
                right: 14px;
                width: 46px;
                height: 46px;
                border: none;
                border-radius: 12px;
                background: rgba(20, 20, 20, 0.65);
                cursor: pointer;
                z-index: 10;
                backdrop-filter: blur(8px);
                box-shadow:
                    inset 0 0 0 1px rgba(255,255,255,0.12),
                    0 8px 24px rgba(0,0,0,0.35);
                transition: transform 0.2s ease, background 0.2s ease;
                pointer-events: auto;
            }

            /* 4 coins fullscreen */
            .fullscreen-btn::before,
            .fullscreen-btn::after {
                content: "";
                position: absolute;
                width: 12px;
                height: 12px;
                border: 2px solid white;
            }

            /* coin haut gauche + bas droit */
            .fullscreen-btn::before {
                top: 11px;
                left: 11px;
                border-right: none;
                border-bottom: none;
            }

            /* coin haut droit + bas gauche */
            .fullscreen-btn::after {
                bottom: 11px;
                right: 11px;
                border-left: none;
                border-top: none;
            }

            /* Hover */
            .fullscreen-btn:hover {
                background: rgba(20, 20, 20, 0.85);
                transform: scale(1.06);
            }

            /* Active */
            .fullscreen-btn:active {
                transform: scale(0.95);
            }

            .iframe-wrapper.fullscreen {
                position: fixed;
                inset: 0;
                width: 100vw;
                height: 100vh;
                z-index: 9999;
                background: black;
                border-radius: 0;
            }

            .iframe-wrapper.fullscreen iframe {
                border-radius: 0;
            }
        </style>
        
        <link rel="stylesheet" type="text/css" href="/DNL-VideoGame/styles/global-style.css">
    </head>
    
    <body style="visibility: hidden;">
        <h1>Game of DNL</h1>
        <div class="iframe-wrapper">
            <iframe
                id="gameFrame"
                src="/DNL-VideoGame/sites/game/site/index.html"
                title="DNL Game">
            </iframe>

            <button class="fullscreen-btn" id="fullscreenBtn" aria-label="Plein écran"></button>
        </div>
    </body>

    <!-- SCRIPTS BASIC -->
    <script src="/DNL-VideoGame/scripts/loading.js"></script>
    <script src="/DNL-VideoGame/scripts/qrcode.js"></script>
    <script>
        const fullscreenBtn = document.getElementById("fullscreenBtn");
        const wrapper = document.querySelector(".iframe-wrapper");

        fullscreenBtn.addEventListener("click", async () => {
            // Si déjà en vrai fullscreen → sortir
            if (document.fullscreenElement) {
                await document.exitFullscreen();
                return;
            }

            // Tentative vrai fullscreen (desktop)
            if (wrapper.requestFullscreen) {
                try {
                    await wrapper.requestFullscreen();
                    return; // succès → on s'arrête
                } catch (err) {
                    // échec → on passe au fallback
                    console.warn("Fullscreen refusé, fallback CSS", err);
                }
            }

            // Fallback mobile / refus navigateur
            wrapper.classList.toggle("fullscreen");
        });

        document.addEventListener("fullscreenchange", () => {
            if (!document.fullscreenElement) {
                wrapper.classList.remove("fullscreen");
            }
        });
    </script>
</html>