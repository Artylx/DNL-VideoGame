<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>

        <style>
            body {
                background-color: black;
                margin: 0;
                padding: 0;

                --size-joystick: 150px;
                --size-joystick-clicker: 80px;
            }

            .joystick-container {
                width: var(--size-joystick);
                height: var(--size-joystick);
                position: absolute;
                bottom: 20px;
                left: calc(50% - 100px / 2);
                background-color: rgb(119, 119, 119);
                border-radius: 50%;
            }

            .joystick {
                width: var(--size-joystick-clicker);
                height: var(--size-joystick-clicker);
                background-color: rgb(59, 59, 59);
                position: relative;
                top: calc(calc(var(--size-joystick) - var(--size-joystick-clicker)) / 2);
                left: calc(calc(var(--size-joystick) - var(--size-joystick-clicker)) / 2);
                border-radius: 50%;
            }
        </style>

        <script>
            window.onload = function() {
                const joystick = document.querySelector('.joystick-container');

                const knob = document.querySelector('.joystick');
                let isDragging = false;
                let startX, startY;

                function startDrag(e) {
                    isDragging = true;
                    const pos = getPosition(e);
                    startX = pos.x;
                    startY = pos.y;
                }

                function stopDrag(e) {
                    if (isDragging) {
                        isDragging = false;
                        knob.style.transform = 'translate(0, 0)';
                        console.log("LachÃ©");
                    }
                }

                function getPosition(e) {
                    if (e.touches && e.touches.length > 0) {
                        return {
                            x: e.touches[0].clientX,
                            y: e.touches[0].clientY
                        };
                    } else {
                        return {
                            x: e.clientX,
                            y: e.clientY
                        };
                    }
                }

                function moveDrag(e) {
                    if (!isDragging) return;

                    const pos = getPosition(e);

                    const dx = pos.x - startX;
                    const dy = pos.y - startY;

                    const distance = Math.sqrt(dx * dx + dy * dy);
                    const maxDistance = 45;

                    if (distance <= maxDistance) {
                        knob.style.transform = `translate(${dx}px, ${dy}px)`;
                    } else {
                        const angle = Math.atan2(dy, dx);
                        knob.style.transform =
                            `translate(${Math.cos(angle) * maxDistance}px,
                                    ${Math.sin(angle) * maxDistance}px)`;
                    }
                }

                knob.addEventListener('mousedown', startDrag);
                document.addEventListener('mousemove', moveDrag);
                document.addEventListener('mouseup', stopDrag);

                knob.addEventListener('touchstart', startDrag, { passive: false });
                document.addEventListener('touchmove', moveDrag, { passive: false });
                document.addEventListener('touchend', stopDrag);
                document.addEventListener('touchcancel', stopDrag);
            };
        </script>
    </head>
    <body>
        <!-- GAME -->

        <div class="joystick-container">
            <div class="joystick"></div>
        </div>
    </body>
</html>